<!DOCTYPE html>
<html lang="hr">
<head>
  <meta charset="UTF-8" />
  <title>Ponude</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 24px; }
    .top { display:flex; justify-content:space-between; align-items:flex-start; gap:16px; }
    table { border-collapse: collapse; width: 100%; margin-top: 12px; }
    th, td { border: 1px solid #ccc; padding: 8px; text-align: right; }
    th:first-child, td:first-child { text-align: left; }
    th { background: #f5f5f5; }
    input { padding: 6px; }
    .row { display:flex; gap:12px; align-items:end; margin-top: 12px; }
    .row > div { flex: 1; }
    .row label { display:block; font-size: 12px; color:#555; margin-bottom:4px; }
    .btn { padding: 8px 12px; cursor: pointer; }
    .muted { color:#666; font-size: 12px; }
  </style>
</head>
<body>

<div class="top">
  <div>
    <h2>Nova ponuda</h2>
    <div class="muted">Prijavljen: {{ user }}</div>
    <div class="muted">Offer ID: {{ offer_id }}</div>
  </div>

  <form action="/logout" method="post">
    <button class="btn" type="submit">Odjava</button>
  </form>
</div>

<form action="/offer/add" method="post" class="row">
  <div style="flex: 2;">
    <label>Naziv</label>
    <input name="name" placeholder="npr. Ormar po mjeri" style="width:100%;" required />
  </div>

  <div>
    <label>Količina</label>
    <input name="qty" type="number" step="0.01" value="1" style="width:100%;" />
  </div>

  <div>
    <label>Cijena</label>
    <input name="price" type="number" step="0.01" value="0" style="width:100%;" />
  </div>

  <div style="flex: 0;">
    <button class="btn" type="submit">Dodaj</button>
  </div>
</form>

<form action="/offer/clear" method="post" style="margin-top: 10px;">
  <button class="btn" type="submit">Obriši sve stavke</button>
  <strong style="margin-left: 12px;">Međuzbroj: {{ "%.2f"|format(subtotal) }} €</strong>
</form>
<a href="/offer.xlsx"><button type="button">Download Excel</button></a>
<a href="/offer.pdf"><button type="button">Download PDF</button></a>

<table>
  <thead>
    <tr>
      <th>Naziv</th>
      <th>Količina</th>
      <th>Cijena</th>
      <th>Ukupno</th>
    </tr>
  </thead>
  <tbody>
    {% if items and items|length > 0 %}
      {% for it in items %}
      <tr>
        <td>{{ it.name }}</td>
        <td>{{ "%.2f"|format(it.qty) }}</td>
        <td>{{ "%.2f"|format(it.price) }}</td>
        <td>{{ "%.2f"|format(it.line_total) }}</td>
      </tr>
      {% endfor %}
    {% else %}
      <tr>
        <td colspan="4" style="text-align:center;color:#666;">Nema stavki. Dodaj prvu stavku gore.</td>
      </tr>
    {% endif %}
  </tbody>
</table>

</body>
</html>
