<!DOCTYPE html>
<html lang="hr">
<head>
  <meta charset="UTF-8">
  <title>Ponuda</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 24px; }
    .row { display: grid; grid-template-columns: 1fr 180px 180px 180px 120px; gap: 12px; align-items: end; }
    input { width: 100%; padding: 8px; }
    button { padding: 8px 14px; }
    table { border-collapse: collapse; width: 100%; margin-top: 18px; }
    th, td { border: 1px solid #ddd; padding: 8px; text-align: right; }
    th:first-child, td:first-child { text-align: left; }
    th { background: #f5f5f5; }
    .top { display:flex; justify-content: space-between; align-items:center; }
  </style>
</head>
<body>

<div class="top">
  <div>
    <h2>Nova ponuda</h2>
    <div>Prijavljen: {{ request.session.get("user") }}</div>
  </div>
  <form action="/logout" method="post">
    <button type="submit">Odjava</button>
  </form>
</div>

<form action="/offer/add" method="post">
  <div class="row">
    <div>
      <label>Naziv</label>
      <input name="name" placeholder="npr. Ormar po mjeri" required>
    </div>
    <div>
      <label>Količina</label>
      <input name="qty" type="text" value="1">
    </div>
    <div>
      <label>Cijena</label>
      <input name="price" type="text" value="0">
    </div>
    <div>
      <label>Ukupno</label>
      <input value="(auto)" disabled>
    </div>
    <div>
      <button type="submit">Dodaj</button>
    </div>
  </div>
</form>

<form action="/offer/clear" method="post" style="margin-top:12px;">
  <button type="submit">Obriši sve stavke</button>
  <strong style="margin-left:12px;">Međuzbroj: {{ "%.2f"|format(subtotal) }} €</strong>
</form>

<table>
  <thead>
    <tr>
      <th>Naziv</th>
      <th>Količina</th>
      <th>Cijena</th>
      <th>Ukupno</th>
    </tr>
  </thead>
  <tbody>
    {% for i in items %}
    <tr>
      <td>{{ i.name if i.name is defined else i["name"] }}</td>
      <td>{{ "%.2f"|format(i.qty if i.qty is defined else i["qty"]) }}</td>
      <td>{{ "%.2f"|format(i.price if i.price is defined else i["price"]) }}</td>
      <td>{{ "%.2f"|format(i.line_total if i.line_total is defined else i["line_total"]) }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

</body>
</html>
